<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fortnite Discovery üó∫Ô∏è</title>  <style>
        @font-face {
            font-family: 'Burbank Big Condensed';
            src: url('path/to/BurbankBigCondensed-Black.ttf') format('truetype');
            /* Replace with the actual path */
            font-weight: 900;
            font-style: normal;
        }

        body {
            font-family: 'Roboto Condensed', sans-serif;
            margin: 0;
            background-color: #0c0f14;
            color: #e0e0e0;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
        }

        /* Header Styles (Moved to Sidebar) */
        .sidebar-header {
            color: #fff;
            font-family: 'Burbank Big Condensed', sans-serif;
            font-size: 2em;
            margin-bottom: 20px;
        }

        .search-bar {
            background-color: #16181d;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            color: #bdc3c7;
            width: 80%;
            margin-bottom: 20px;
        }

        /* Sidebar Styles */
        .sidebar {
            width: 200px;
            margin-right: 20px;
            padding-top: 20px;
        }

        .category-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .category-item {
            background-color: #16181d;
            padding: 8px 15px;
            border-radius: 5px;
            color: #bdc3c7;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin-bottom: 5px;
            position: relative; /* For the emoji animation */
            overflow: hidden; /* Clip the bounce */
        }

        .category-item:hover {
            background-color: #222;
        }

        /* Main Content Styles */
        #discovery-content {
            flex: 1;
        }

        .category-title {
            color: #fff;
            font-family: 'Burbank Big Condensed', sans-serif;
            font-size: 1.5em;
            margin-bottom: 15px;
            text-transform: uppercase;
        }

        .discovery-row {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            overflow-x: auto;
            padding-bottom: 10px;
            max-width: calc(5 * (160px + 15px));
        }

        .island-card {
            background-color: #16181d;
            border-radius: 5px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            width: 160px;
            flex-shrink: 0;
            transition: transform 0.2s ease-in-out, opacity 0.3s ease-in-out;
            display: flex;
            flex-direction: column;
            opacity: 1;
        }

        .island-card:hover {
            transform: scale(1.05);
        }

        .card-header {
            position: relative;
        }

        .rank {
            position: absolute;
            top: 5px;
            left: 5px;
            background-color: rgba(0, 0, 0, 0.7);
            color: #fff;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            font-size: 0.7em;
            font-weight: bold;
            font-family: 'Burbank Big Condensed', sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1;
        }

        .island-image-container {
            position: relative;
        }

        .island-image {
            width: 100%;
            height: 90px;
            object-fit: cover;
            display: block;
        }

        .player-count {
            position: absolute;
            top: 5px;
            right: 5px;
            background-color: rgba(0, 0, 0, 0.7);
            color: #fff;
            padding: 2px 5px;
            border-radius: 3px;
            font-size: 0.7em;
            font-weight: bold;
            z-index: 1;
            transition: opacity 0.3s ease-in-out;
            opacity: 1;
            display: flex;         /* Flexbox */
            align-items: center;    /* Vertical center */
            justify-content: center; /* Horizontal center */
            gap: 2px;               /* Space between text/emoji */
        }

        .card-body {
            padding: 8px;
            text-align: center;
        }

        .island-title {
            font-weight: bold;
            font-size: 0.8em;
            color: #f0f0f0;
            margin-bottom: 0;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
        }

        #loading {
            text-align: center;
            margin-top: 20px;
            font-style: italic;
            color: #757575;
            font-size: 1.2em;
        }

        .category-section {
            margin-bottom: 30px;
            transition: opacity 0.3s ease-in-out;
            opacity: 1;
        }

        .category-section:last-child {
            margin-bottom: 0;
        }

        .map-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 15px;
        }

        .hidden {
            opacity: 0;
            display: none;
            transition: opacity 0.3s ease-in-out;
        }

        #timer {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: rgba(0, 0, 0, 0.7);
            color: #fff;
            padding: 10px;
            border-radius: 5px;
            font-size: 0.9em;
            z-index: 1000;
            display: flex;       /* Flexbox for centering */
            align-items: center;  /* Vertical centering */
            justify-content: center; /* Horizontal centering */
            gap: 5px;             /* Space between text and emoji */
        }

        #back-to-top {
            position: fixed;
            bottom: 80px;  /* Adjusted to make space for timer */
            right: 20px;
            background-color: rgba(0, 0, 0, 0.7);
            color: #fff;
            padding: 10px;
            border-radius: 5px;
            font-size: 1.5em;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1000;
            display: flex;       /* Flexbox for centering */
            align-items: center;  /* Vertical centering */
            justify-content: center; /* Horizontal centering */
        }

        #back-to-top.show {
            opacity: 1;
        }

        #initial-loading {
            text-align: center;
            margin-top: 20px;
            font-style: italic;
            color: #757575;
            font-size: 2em; /* Bigger! */
            opacity: 0;
            transform: scale(0.8); /* Start smaller */
            animation: initialLoadAnimation 1s ease-out forwards;
        }

        @keyframes initialLoadAnimation {
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
    </style>
</head>

<body>
    <div id="initial-loading">Loading data... ‚è≥</div>  <div class="container" style="display: none;">
        <aside class="sidebar">
            <h1 class="sidebar-header">Fortnite Discovery üó∫Ô∏è</h1> <input type="text" class="search-bar" id="search-input" placeholder="Search üîç..."> <ul class="category-list" id="category-list">
                </ul>
        </aside>
        <div id="discovery-content">
            <p id="loading">Loading data... ‚è≥</p>  </div>
    </div>
    <div id="back-to-top">‚¨ÜÔ∏è</div>  <div id="timer">Next update in: <span id="countdown"></span> ‚è±Ô∏è</div> <script>
        const initialLoading = document.getElementById('initial-loading');
        const container = document.querySelector('.container');
        const discoveryContent = document.getElementById('discovery-content');
        const categoryList = document.getElementById('category-list');
        const searchInput = document.getElementById('search-input');
        const countdownElement = document.getElementById('countdown');
        const updateInterval = 30000; // 30 seconds (was 60000)
        let nextUpdateTime;
        const backToTopButton = document.getElementById('back-to-top'); // Get the arrow

        let allCategories = [];

        function formatPlayerCount(count) {
            if (count >= 1000) {
                return (count / 1000).toFixed(1) + "K Players üßë‚Äçü§ù‚Äçüßë";  // Players emoji
            }
            return count + " Players üßë‚Äçü§ù‚Äçüßë";  // Players emoji
        }

        function displayCategories(categories) {
            initialLoading.style.display = 'none';
            container.style.display = 'flex';

            discoveryContent.innerHTML = '';
            categoryList.innerHTML = '';

            const visibleCategories = [];

            categories.forEach(category => {
                const categorySection = document.createElement('div');
                categorySection.classList.add('category-section');

                const title = document.createElement('h2');
                title.classList.add('category-title');
                title.textContent = category.panelName;

                categorySection.appendChild(title);

                // Add category to the fast travel list (sidebar)
                const categoryItem = document.createElement('li');
                categoryItem.classList.add('category-item');
                categoryItem.textContent = category.panelName;
                categoryItem.addEventListener('click', () => {
                    categorySection.scrollIntoView({ behavior: 'smooth' });
                });
                categoryList.appendChild(categoryItem);

                const mapGrid = document.createElement('div');
                mapGrid.classList.add('map-grid');

                // Filter islands based on search term
                const searchTerm = searchInput.value.toLowerCase();
                const filteredIslands = category.results.filter(island =>
                    island.islandTitle.toLowerCase().includes(searchTerm) ||
                    island.islandCode.toLowerCase().includes(searchTerm) ||
                    (island.creatorSlug && island.creatorSlug.toLowerCase().includes(searchTerm)) // Check creatorSlug
                );

                if (filteredIslands.length > 0) {
                    visibleCategories.push(category.panelName);
                    filteredIslands.forEach((island, index) => {
                        const islandCard = document.createElement('div');
                        islandCard.classList.add('island-card');
                        islandCard.style.opacity = 0;
                        setTimeout(() => {
                            islandCard.style.opacity = 1;
                        }, 50 * index);

                        const cardHeader = document.createElement('div');
                        cardHeader.classList.add('card-header');

                        if (island.islandRank) {
                            const rank = document.createElement('span');
                            rank.classList.add('rank');
                            rank.textContent = island.islandRank;
                            cardHeader.appendChild(rank);
                        }

                        const imageContainer = document.createElement('div');
                        imageContainer.classList.add('island-image-container');

                        const image = document.createElement('img');
                        image.src = island.smallImage;
                        image.alt = island.islandTitle;
                        image.classList.add('island-image');

                        const playerCount = document.createElement('span');
                        playerCount.classList.add('player-count');
                        playerCount.textContent = formatPlayerCount(island.globalCCU || 0);
                        imageContainer.appendChild(image);
                        imageContainer.appendChild(playerCount);

                        cardHeader.appendChild(imageContainer);

                        const cardBody = document.createElement('div');
                        cardBody.classList.add('card-body');

                        const islandTitle = document.createElement('h3');
                        islandTitle.classList.add('island-title');
                        islandTitle.textContent = island.islandTitle;

                        cardBody.appendChild(islandTitle);

                        islandCard.appendChild(cardHeader);
                        islandCard.appendChild(cardBody);
                        mapGrid.appendChild(islandCard);
                    });

                    categorySection.appendChild(mapGrid);
                    discoveryContent.appendChild(categorySection);
                } else {
                    categorySection.style.opacity = 0;
                    setTimeout(() => {
                        categorySection.style.display = 'none';
                    }, 300);
                }
            });

            // Filter sidebar category items
            const sidebarItems = document.querySelectorAll('#category-list .category-item');
            sidebarItems.forEach(item => {
                if (visibleCategories.includes(item.textContent)) {
                    item.classList.remove('hidden');
                } else {
                    item.classList.add('hidden');
                }
            });

            // Animate player counts (simple fade)
            const playerCountElements = document.querySelectorAll('.player-count');
            playerCountElements.forEach(el => {
                el.style.opacity = 0.5;
                setTimeout(() => {
                    el.style.opacity = 1;
                }, 300);
            });
        }

        function fetchData() {
            fetch('https://fnzone.es/_next/data/TDYxmKfi6TY7EFeLq5QA8/en/creative.json')
                .then(response => response.json())
                .then(data => {
                    allCategories = data.pageProps.data;
                    displayCategories(allCategories);
                    nextUpdateTime = Date.now() + updateInterval;
                    updateCountdown();
                })
                .catch(error => {
                    discoveryContent.innerHTML = '<p>An error occurred while loading data. üò≠</p>';  // Crying face emoji
                    console.error('Error loading data:', error);
                });
        }

        function updateCountdown() {
            const timeLeft = nextUpdateTime - Date.now();

            if (timeLeft > 0) {
                const seconds = Math.floor(timeLeft / 1000);
                countdownElement.textContent = seconds + "s";
            } else {
                countdownElement.textContent = "Updating... üîÑ";  // Refresh emoji
            }
        }

        fetchData();
        setInterval(fetchData, updateInterval);
        setInterval(updateCountdown, 100);

        searchInput.addEventListener('input', () => {
            displayCategories(allCategories);
        });

        // --- "Back to Top" Arrow Functionality ---

        window.addEventListener('scroll', () => {
            if (window.scrollY > 300) {  // Show after scrolling 300px (adjust as needed)
                backToTopButton.classList.add('show');
            } else {
                backToTopButton.classList.remove('show');
            }
        });

        backToTopButton.addEventListener('click', () => {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'   // Smooth scroll!
            });
        });
    </script>
</body>

</html>
